<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>å€æ•¸åˆ¤æ–·ç·´ç¿’ï½œä¸»é¡Œé¸æ“‡ï¼‹å¡«ç©ºé¡Œç‰ˆ</title>
<style>
body{font-family:"Microsoft JhengHei","PingFang TC",Arial,sans-serif;background:#f4f8f9;color:#333;line-height:1.8;margin:0}
.container{max-width:900px;margin:24px auto;padding:24px;background:#fff;border-radius:16px;box-shadow:0 8px 24px rgba(0,0,0,.06)}
h1{margin:0 0 12px;text-align:center;color:#0b63c6}
p.lead{text-align:center;margin-bottom:20px}
.menu{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:16px;margin:12px 0}
.topic-btn{border:none;border-radius:14px;padding:16px;cursor:pointer;color:#fff;font-weight:700;font-size:18px;display:flex;align-items:center;justify-content:center;gap:10px;box-shadow:0 6px 16px rgba(0,0,0,.08);transition:transform .06s,filter .2s}
.topic-btn:active{transform:translateY(1px)}
.c2{background:#3b82f6}.c3{background:#f59e0b}.c4{background:#10b981}.c5{background:#ef4444}.c9{background:#8b5cf6}.c11{background:#14b8a6}
.subtle{font-size:13px;opacity:.9}
.rule-section{margin:20px 0 28px;border-top:1px solid #eee;padding-top:18px}
h2{margin:0 0 10px;color:#0b63c6}
.rule-description{background:#fdfdee;border:1px solid #f0e68c;padding:14px;border-radius:10px;margin:10px 0 14px}
.question{background:#fafafa;border:1px solid #e6e6e6;border-radius:10px;padding:14px;margin:10px 0;display:flex;flex-wrap:wrap;align-items:center;gap:10px;font-size:17px}
.question-text{font-weight:600;margin-right:8px}
.question label{cursor:pointer;margin-right:8px}
.question input[type="radio"]{transform:scale(1.2);margin-right:4px}
.question input[type="text"]{padding:8px 10px;border:1px solid #ccc;border-radius:8px;width:220px}
.check-btn{background:#0b63c6;color:#fff;border:none;border-radius:8px;padding:8px 14px;font-weight:700;cursor:pointer}
.check-btn:hover{filter:brightness(.95)}
.feedback{font-weight:800}
.feedback.correct{color:#16a34a}
.feedback.incorrect{color:#dc2626}
.bar{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin:18px 0}
.btn{border:none;border-radius:10px;padding:10px 16px;font-weight:800;color:#fff;cursor:pointer}
.btn-primary{background:#0ea5e9}.btn-danger{background:#ef4444}.btn-secondary{background:#64748b}
.btn:hover{filter:brightness(.95)}
#score-output{text-align:center;font-weight:800;color:#0b63c6}
@media(max-width:640px){.menu{grid-template-columns:repeat(2,minmax(0,1fr))}.question{flex-direction:column;align-items:flex-start}}
</style>
</head>
<body>
<div class="container">
  <h1>ğŸ”¢ å€æ•¸åˆ¤æ–·ç·´ç¿’</h1>
  <p class="lead">è«‹å…ˆé¸æ“‡ç·´ç¿’ä¸»é¡Œï¼ˆæ¯æ¬¡æœƒè‡ªå‹•ç”¢ç”Ÿæ–°é¡Œç›®ï¼‰ã€‚</p>
  <div id="menu">
    <div class="menu">
      <button class="topic-btn c2" data-base="2">2ï¸âƒ£ 2 çš„å€æ•¸<br><span class="subtle">å¶æ•¸åˆ¤æ–·</span></button>
      <button class="topic-btn c3" data-base="3">3ï¸âƒ£ 3 çš„å€æ•¸<br><span class="subtle">æ•¸å­—å’Œæ˜¯ 3 çš„å€æ•¸</span></button>
      <button class="topic-btn c4" data-base="4">4ï¸âƒ£ 4 çš„å€æ•¸<br><span class="subtle">æœ«å…©ä½æ˜¯ 4 çš„å€æ•¸</span></button>
      <button class="topic-btn c5" data-base="5">5ï¸âƒ£ 5 çš„å€æ•¸<br><span class="subtle">å€‹ä½ 0 æˆ– 5</span></button>
      <button class="topic-btn c9" data-base="9">9ï¸âƒ£ 9 çš„å€æ•¸<br><span class="subtle">æ•¸å­—å’Œæ˜¯ 9 çš„å€æ•¸</span></button>
      <button class="topic-btn c11" data-base="11">1ï¸âƒ£1ï¸âƒ£ 11 çš„å€æ•¸<br><span class="subtle">å¥‡å¶ä½å·®ç‚º 0 æˆ– 11 çš„å€æ•¸</span></button>
    </div>
  </div>

  <div id="quiz-area" style="display:none"></div>
  <div id="controls" class="bar" style="display:none">
    <button id="back-btn" class="btn btn-secondary">â¬…ï¸ å›ä¸»é¡Œé¸å–®</button>
    <button id="reset-btn" class="btn btn-danger">ğŸ”„ å…¨éƒ¨é‡ä¾†</button>
    <button id="score-btn" class="btn btn-primary">ğŸ“Š æŸ¥çœ‹åˆ†æ•¸</button>
  </div>
  <p id="score-output"></p>
</div>

<script>
document.addEventListener('DOMContentLoaded',()=>{
  const menu=document.getElementById('menu');
  const quizArea=document.getElementById('quiz-area');
  const controls=document.getElementById('controls');
  const scoreOut=document.getElementById('score-output');
  const STORAGE_PREFIX='multiple_quiz_topic_';
  let currentBase=null;

  const rnd3=()=>Math.floor(100+Math.random()*900);
  const isMultiple={
    2:n=>n%2===0,
    3:n=>n.toString().split('').reduce((a,b)=>a+ +b,0)%3===0,
    4:n=>n%4===0,
    5:n=>n%5===0,
    9:n=>n.toString().split('').reduce((a,b)=>a+ +b,0)%9===0,
    11:n=>{
      const d=n.toString().split('').map(Number);let o=0,e=0;
      for(let i=0;i<d.length;i++){const fromRight=d[d.length-1-i];if(i%2===0)o+=fromRight;else e+=fromRight;}
      return Math.abs(o-e)%11===0;
    }
  };
  const ruleText={
    2:"å€‹ä½æ•¸æ˜¯ 0ã€2ã€4ã€6ã€8 çš„æ•´æ•¸ï¼Œä¸€å®šæ˜¯ 2 çš„å€æ•¸ã€‚",
    3:"å„ä½æ•¸å­—çš„ç¸½å’Œæ˜¯ 3 çš„å€æ•¸ï¼Œè©²æ•¸å°±æ˜¯ 3 çš„å€æ•¸ã€‚",
    4:"æœ«å…©ä½æ•¸æ˜¯ 00 æˆ– 4 çš„å€æ•¸ï¼Œæ•´æ•¸å°±æ˜¯ 4 çš„å€æ•¸ã€‚",
    5:"å€‹ä½æ•¸æ˜¯ 0 æˆ– 5 çš„æ•´æ•¸ï¼Œä¸€å®šæ˜¯ 5 çš„å€æ•¸ã€‚",
    9:"å„ä½æ•¸å­—çš„ç¸½å’Œæ˜¯ 9 çš„å€æ•¸ï¼Œè©²æ•¸å°±æ˜¯ 9 çš„å€æ•¸ã€‚",
    11:"å¥‡æ•¸ä½å’Œèˆ‡å¶æ•¸ä½å’Œçš„å·®ç‚º 0 æˆ– 11 çš„å€æ•¸ï¼Œå³ç‚º 11 çš„å€æ•¸ã€‚"
  };
// å°‡ä½ çš„ fillQuestions ç‰©ä»¶æ•´æ®µæ›¿æ›æˆé€™ä¸€æ®µ
const fillQuestions = {
  2:  { text: "è‹¥æ•¸å­—ã€Œ4â–¡ã€æ˜¯ 2 çš„å€æ•¸ï¼Œâ–¡ï¼ï¼Ÿ",   ans: "0,2,4,6,8" },
  3:  { text: "è‹¥æ•¸å­—ã€Œ23â–¡ã€æ˜¯ 3 çš„å€æ•¸ï¼Œâ–¡ï¼ï¼Ÿ",  ans: "1,4,7" },
  4:  { text: "è‹¥æ•¸å­—ã€Œâ–¡6ã€æ˜¯ 4 çš„å€æ•¸ï¼Œâ–¡ï¼ï¼Ÿ",   ans: "1,3,5,7,9" }, // â† ä¿®æ­£é€™è¡Œ
  5:  { text: "è‹¥æ•¸å­—ã€Œ67â–¡ã€æ˜¯ 5 çš„å€æ•¸ï¼Œâ–¡ï¼ï¼Ÿ",  ans: "0,5" },
  9:  { text: "è‹¥æ•¸å­—ã€Œ45â–¡ã€æ˜¯ 9 çš„å€æ•¸ï¼Œâ–¡ï¼ï¼Ÿ",  ans: "0,9" },
  11: { text: "è‹¥æ•¸å­—ã€Œ1â–¡1ã€æ˜¯ 11 çš„å€æ•¸ï¼Œâ–¡ï¼ï¼Ÿ", ans: "2" }          // â† ä¿®æ­£é€™è¡Œ
};
  const normalize=s=>s.replace(/ï¼Œ/g,',').split(',').map(x=>x.trim()).filter(Boolean).sort().join(',');

  document.querySelectorAll('.topic-btn').forEach(b=>b.addEventListener('click',()=>enterTopic(b.dataset.base)));
  document.getElementById('back-btn').onclick=()=>{quizArea.innerHTML='';quizArea.style.display='none';controls.style.display='none';menu.style.display='block';scoreOut.textContent='';currentBase=null;}
  document.getElementById('reset-btn').onclick=()=>{if(!currentBase)return;localStorage.removeItem(STORAGE_PREFIX+currentBase);scoreOut.textContent='';generateQuiz(currentBase);}
  document.getElementById('score-btn').onclick=()=>{
    const qs=quizArea.querySelectorAll('.question');let c=0,t=qs.length;
    qs.forEach(q=>{const a=q.dataset.answer;
      if(q.classList.contains('fill-in')){
        if(normalize(q.querySelector('.fill-in-answer').value)===a)c++;
      }else{
        const s=q.querySelector('input[type="radio"]:checked');if(s&&s.value===a)c++;
      }
    });
    scoreOut.textContent=`æœ¬ä¸»é¡Œå…± ${t} é¡Œï¼Œç­”å° ${c} é¡Œï¼Œæ­£ç¢ºç‡ ${(c/t*100).toFixed(0)}%`;
  };

  function enterTopic(base){currentBase=String(base);menu.style.display='none';quizArea.style.display='block';controls.style.display='flex';generateQuiz(currentBase);loadProgress(currentBase);}

  function generateQuiz(base){
    quizArea.innerHTML='';
    const sec=document.createElement('div');sec.className='rule-section';
    sec.innerHTML=`<h2>${base} çš„å€æ•¸åˆ¤æ–·</h2><p class="rule-description">${ruleText[base]}</p>`;
    for(let i=1;i<=4;i++){
      const n=rnd3();const ans=isMultiple[base](n)?'is':'not';
      const q=document.createElement('div');q.className='question';q.dataset.id=`${base}_${i}`;q.dataset.answer=ans;
      q.innerHTML=`<span class="question-text">${i}. ${n}</span>
      <label><input type="radio" name="${base}_${i}" value="is">æ˜¯</label>
      <label><input type="radio" name="${base}_${i}" value="not">ä¸æ˜¯</label>
      <button class="check-btn">æª¢æŸ¥</button><span class="feedback"></span>`;
      sec.appendChild(q);
    }
    // åŠ ä¸Šå¡«ç©ºé¡Œ
    const f=fillQuestions[base];
    if(f){
      const qf=document.createElement('div');qf.className='question fill-in';qf.dataset.id=`${base}_fill`;qf.dataset.answer=f.ans;
      qf.innerHTML=`<span class="question-text">5. ${f.text}</span>
      <input type="text" class="fill-in-answer" placeholder="å¡«å…¥æ‰€æœ‰å¯èƒ½æ•¸å­—,ç”¨é€—è™Ÿ,åˆ†éš”">
      <button class="check-btn">æª¢æŸ¥</button><span class="feedback"></span>`;
      sec.appendChild(qf);
    }
    quizArea.appendChild(sec);
    bindEvents();
  }

  function bindEvents(){
    quizArea.querySelectorAll('.check-btn').forEach(btn=>{
      btn.onclick=()=>{
        const q=btn.closest('.question');const fb=q.querySelector('.feedback');let ok=false;
        if(q.classList.contains('fill-in')){
          const v=normalize(q.querySelector('.fill-in-answer').value);
          if(!v){fb.textContent='è«‹å¡«å…¥ç­”æ¡ˆ';fb.className='feedback incorrect';return;}
          ok=(v===q.dataset.answer);
        }else{
          const s=q.querySelector('input[type="radio"]:checked');
          if(!s){fb.textContent='è«‹é¸æ“‡ç­”æ¡ˆ';fb.className='feedback incorrect';return;}
          ok=(s.value===q.dataset.answer);
        }
        fb.textContent=ok?'ç­”å°äº†ï¼ğŸ‰':'å†è©¦ä¸€æ¬¡ï¼ğŸ’ª';
        fb.className='feedback '+(ok?'correct':'incorrect');
        saveProgress(currentBase);
      };
    });
    quizArea.querySelectorAll('input[type="radio"],input[type="text"]').forEach(el=>{
      el.addEventListener('input',()=>saveProgress(currentBase));
      el.addEventListener('change',()=>saveProgress(currentBase));
    });
  }

  function saveProgress(base){
    if(!base)return;
    const key=STORAGE_PREFIX+base;const data={};
    quizArea.querySelectorAll('.question').forEach(q=>{
      const id=q.dataset.id;if(!id)return;
      if(q.classList.contains('fill-in')){
        data[id]={type:'text',value:q.querySelector('.fill-in-answer')?.value||""};
      }else{
        const s=q.querySelector('input[type="radio"]:checked');
        data[id]={type:'radio',value:s?s.value:""};
      }
    });
    localStorage.setItem(key,JSON.stringify(data));
  }
  function loadProgress(base){
    if(!base)return;
    const key=STORAGE_PREFIX+base;const data=JSON.parse(localStorage.getItem(key)||"{}");
    Object.entries(data).forEach(([id,it])=>{
      const q=quizArea.querySelector(`[data-id="${id}"]`);if(!q)return;
      if(it.type==='text'){const inp=q.querySelector('.fill-in-answer');if(inp)inp.value=it.value||"";}
      else if(it.type==='radio'&&it.value){const r=q.querySelector(`input[type="radio"][value="${it.value}"]`);if(r)r.checked=true;}
    });
  }
});
</script>
</body>
</html>
