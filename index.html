<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>å€æ•¸åˆ¤æ–·ç·´ç¿’ï½œä¸»é¡Œé¸æ“‡ç‰ˆ</title>
<style>
  body{
    font-family:"Microsoft JhengHei","PingFang TC",Arial,sans-serif;
    background:#f4f8f9;color:#333;line-height:1.8;margin:0
  }
  .container{max-width:900px;margin:24px auto;padding:24px;background:#fff;border-radius:16px;box-shadow:0 8px 24px rgba(0,0,0,.06)}
  h1{margin:0 0 12px;text-align:center;color:#0b63c6}
  p.lead{margin:0 0 20px;text-align:center}
  /* é¸å–® */
  .menu{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:16px;margin:12px 0 8px}
  .topic-btn{
    border:none;border-radius:14px;padding:16px;cursor:pointer;color:#fff;font-weight:700;font-size:18px;
    display:flex;align-items:center;justify-content:center;gap:10px;box-shadow:0 6px 16px rgba(0,0,0,.08);
    transition:transform .06s ease, filter .2s ease
  }
  .topic-btn:active{transform:translateY(1px)}
  .c2{background:#3b82f6}  .c3{background:#f59e0b}
  .c4{background:#10b981}  .c5{background:#ef4444}
  .c9{background:#8b5cf6}  .c11{background:#14b8a6}
  .subtle{font-size:13px;opacity:.9}

  /* é¡Œç›® */
  .rule-section{margin:20px 0 28px;border-top:1px solid #eee;padding-top:18px}
  h2{margin:0 0 10px;color:#0b63c6}
  .rule-description{background:#fdfdee;border:1px solid #f0e68c;padding:14px;border-radius:10px;margin:10px 0 14px}
  .question{
    background:#fafafa;border:1px solid #e6e6e6;border-radius:10px;padding:14px;margin:10px 0;
    display:flex;flex-wrap:wrap;align-items:center;gap:10px;font-size:17px
  }
  .question .question-text{font-weight:600;margin-right:8px}
  .question label{cursor:pointer;margin-right:8px}
  .question input[type="radio"]{transform:scale(1.2);margin-right:4px}
  .question input[type="text"]{padding:8px 10px;border:1px solid #ccc;border-radius:8px;width:220px}
  .check-btn{
    background:#0b63c6;color:#fff;border:none;border-radius:8px;padding:8px 14px;font-weight:700;cursor:pointer
  }
  .check-btn:hover{filter:brightness(.95)}
  .feedback{font-weight:800}
  .feedback.correct{color:#16a34a}
  .feedback.incorrect{color:#dc2626}

  /* æ§åˆ¶æŒ‰éˆ• */
  .bar{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin:18px 0}
  .btn{
    border:none;border-radius:10px;padding:10px 16px;font-weight:800;color:#fff;cursor:pointer
  }
  .btn-primary{background:#0ea5e9}
  .btn-danger{background:#ef4444}
  .btn-secondary{background:#64748b}
  .btn:hover{filter:brightness(.95)}
  #score-output{text-align:center;font-weight:800;color:#0b63c6}

  @media (max-width:640px){
    .menu{grid-template-columns:repeat(2,minmax(0,1fr))}
    .question{flex-direction:column;align-items:flex-start}
  }
</style>
</head>
<body>
  <div class="container">
    <h1>ğŸ”¢ å€æ•¸åˆ¤æ–·ç·´ç¿’</h1>
    <p class="lead">è«‹å…ˆé¸æ“‡ç·´ç¿’ä¸»é¡Œï¼ˆæ¯æ¬¡æœƒè‡ªå‹•ç”¢ç”Ÿæ–°é¡Œç›®ï¼‰ã€‚</p>

    <!-- ä¸»é¡Œé¸å–® -->
    <div id="menu">
      <div class="menu">
        <button class="topic-btn c2"  data-base="2">2ï¸âƒ£ 2 çš„å€æ•¸<br><span class="subtle">å¶æ•¸åˆ¤æ–·</span></button>
        <button class="topic-btn c3"  data-base="3">3ï¸âƒ£ 3 çš„å€æ•¸<br><span class="subtle">æ•¸å­—å’Œæ˜¯ 3 çš„å€æ•¸</span></button>
        <button class="topic-btn c4"  data-base="4">4ï¸âƒ£ 4 çš„å€æ•¸<br><span class="subtle">æœ«å…©ä½æ˜¯ 4 çš„å€æ•¸</span></button>
        <button class="topic-btn c5"  data-base="5">5ï¸âƒ£ 5 çš„å€æ•¸<br><span class="subtle">å€‹ä½ 0 æˆ– 5</span></button>
        <button class="topic-btn c9"  data-base="9">9ï¸âƒ£ 9 çš„å€æ•¸<br><span class="subtle">æ•¸å­—å’Œæ˜¯ 9 çš„å€æ•¸</span></button>
        <button class="topic-btn c11" data-base="11">1ï¸âƒ£1ï¸âƒ£ 11 çš„å€æ•¸<br><span class="subtle">å¥‡å¶ä½å·®æ˜¯ 0 æˆ– 11 çš„å€æ•¸</span></button>
      </div>
    </div>

    <!-- é¡Œç›®å€ -->
    <div id="quiz-area" style="display:none"></div>

    <!-- æ§åˆ¶åˆ— -->
    <div id="controls" class="bar" style="display:none">
      <button id="back-btn"  class="btn btn-secondary">â¬…ï¸ å›ä¸»é¡Œé¸å–®</button>
      <button id="reset-btn" class="btn btn-danger">ğŸ”„ å…¨éƒ¨é‡ä¾†ï¼ˆé‡æ–°å‡ºé¡Œï¼‰</button>
      <button id="score-btn" class="btn btn-primary">ğŸ“Š æŸ¥çœ‹åˆ†æ•¸</button>
    </div>
    <p id="score-output"></p>
  </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const menu = document.getElementById('menu');
  const quizArea = document.getElementById('quiz-area');
  const controls = document.getElementById('controls');
  const scoreOut = document.getElementById('score-output');
  const STORAGE_PREFIX = 'multiple_quiz_topic_';

  let currentBase = null;

  // å·¥å…·ï¼šä¸‰ä½æ•¸
  const rnd3 = () => Math.floor(100 + Math.random()*900);

  // å€æ•¸æª¢æŸ¥
  const isMultiple = {
    2:n=>n%2===0,
    3:n=>n.toString().split('').reduce((a,b)=>a+ +b,0)%3===0,
    4:n=>n%4===0,
    5:n=>n%5===0,
    9:n=>n.toString().split('').reduce((a,b)=>a+ +b,0)%9===0,
    11:n=>{
      const d=n.toString().split('').map(Number);
      let odd=0, even=0;
      // å¾å€‹ä½æ•¸ç®—èµ·ï¼šå€‹ä½=å¥‡ä½
      for(let i=0;i<d.length;i++){
        const fromRight=d[d.length-1-i];
        if(i%2===0) odd+=fromRight; else even+=fromRight;
      }
      return Math.abs(odd-even)%11===0;
    }
  };

  // è¦å‰‡æ–‡æ¡ˆ
  const ruleText = {
    2:"å€‹ä½æ•¸æ˜¯ 0ã€2ã€4ã€6ã€8 çš„æ•´æ•¸ï¼Œä¸€å®šæ˜¯ 2 çš„å€æ•¸ã€‚",
    3:"å„ä½æ•¸å­—çš„ç¸½å’Œæ˜¯ 3 çš„å€æ•¸ï¼Œè©²æ•¸å°±æ˜¯ 3 çš„å€æ•¸ã€‚",
    4:"æœ«å…©ä½æ•¸æ˜¯ 00 æˆ– 4 çš„å€æ•¸ï¼Œæ•´æ•¸å°±æ˜¯ 4 çš„å€æ•¸ã€‚",
    5:"å€‹ä½æ•¸æ˜¯ 0 æˆ– 5 çš„æ•´æ•¸ï¼Œä¸€å®šæ˜¯ 5 çš„å€æ•¸ã€‚",
    9:"å„ä½æ•¸å­—çš„ç¸½å’Œæ˜¯ 9 çš„å€æ•¸ï¼Œè©²æ•¸å°±æ˜¯ 9 çš„å€æ•¸ã€‚",
    11:"å¥‡æ•¸ä½å’Œèˆ‡å¶æ•¸ä½å’Œçš„å·®ç‚º 0 æˆ– 11 çš„å€æ•¸ï¼Œå³ç‚º 11 çš„å€æ•¸ã€‚"
  };

  // å®¹éŒ¯ï¼šå…¨å½¢é€—è™Ÿ
  const normalize = s=> s.replace(/ï¼Œ/g,',').split(',').map(x=>x.trim()).filter(Boolean).sort().join(',');

  // ç¶å®šä¸»é¡ŒæŒ‰éˆ•
  document.querySelectorAll('.topic-btn').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const base = btn.dataset.base;
      enterTopic(base);
    });
  });

  // é€²å…¥ä¸»é¡Œ
  function enterTopic(base){
    currentBase = String(base);
    scoreOut.textContent = '';
    menu.style.display='none';
    quizArea.style.display='block';
    controls.style.display='flex';
    generateQuiz(currentBase);
    loadProgress(currentBase);
  }

  // è¿”å›é¸å–®
  document.getElementById('back-btn').addEventListener('click', ()=>{
    quizArea.innerHTML = '';
    quizArea.style.display='none';
    controls.style.display='none';
    scoreOut.textContent='';
    menu.style.display='block';
    currentBase = null;
  });

  // é‡æ–°å‡ºé¡Œ
  document.getElementById('reset-btn').addEventListener('click', ()=>{
    if(!currentBase) return;
    localStorage.removeItem(STORAGE_PREFIX+currentBase);
    scoreOut.textContent='';
    generateQuiz(currentBase);
  });

  // æŸ¥çœ‹åˆ†æ•¸
  document.getElementById('score-btn').addEventListener('click', ()=>{
    const qs = quizArea.querySelectorAll('.question');
    let c=0, t=qs.length;
    qs.forEach(q=>{
      const ans=q.dataset.answer;
      if(q.classList.contains('fill-in')){
        const v = normalize(q.querySelector('.fill-in-answer').value);
        if(v===ans) c++;
      }else{
        const s=q.querySelector('input[type="radio"]:checked');
        if(s && s.value===ans) c++;
      }
    });
    scoreOut.textContent = `æœ¬ä¸»é¡Œå…± ${t} é¡Œï¼Œç­”å° ${c} é¡Œï¼Œæ­£ç¢ºç‡ ${(c/t*100).toFixed(0)}%`;
  });

  // å‡ºé¡Œæ ¸å¿ƒ
  function generateQuiz(base){
    quizArea.innerHTML = '';
    const sec = document.createElement('div');
    sec.className='rule-section';
    sec.innerHTML = `
      <h2>${base} çš„å€æ•¸åˆ¤æ–·</h2>
      <p class="rule-description">${ruleText[base]}</p>
    `;
    // å››é¡Œéš¨æ©Ÿ
    for(let i=1;i<=4;i++){
      const n = rnd3();
      const ans = isMultiple[base](n) ? 'is' : 'not';
      const q = document.createElement('div');
      q.className='question';
      q.dataset.id = `${base}_${i}`;
      q.dataset.answer = ans;
      q.innerHTML = `
        <span class="question-text">${i}. ${n}</span>
        <label><input type="radio" name="${base}_${i}" value="is">æ˜¯</label>
        <label><input type="radio" name="${base}_${i}" value="not">ä¸æ˜¯</label>
        <button class="check-btn">æª¢æŸ¥</button>
        <span class="feedback"></span>
      `;
      sec.appendChild(q);
    }
    // ä¿ç•™ä¸€é¡Œå¡«ç©ºï¼ˆæ”¾åœ¨ 3 çš„ä¸»é¡Œï¼‰
    if(base === '3'){
      const q5 = document.createElement('div');
      q5.className='question fill-in';
      q5.dataset.id = `${base}_fill`;
      q5.dataset.answer = '1,4,7';
      q5.innerHTML = `
        <span class="question-text">5. è‹¥æ•¸å­—ã€Œ23â–¡ã€æ˜¯ 3 çš„å€æ•¸ï¼Œâ–¡ï¼ï¼Ÿ</span>
        <input type="text" class="fill-in-answer" placeholder="å¡«å…¥æ‰€æœ‰å¯èƒ½æ•¸å­—,ç”¨é€—è™Ÿ,åˆ†éš”">
        <button class="check-btn">æª¢æŸ¥</button>
        <span class="feedback"></span>
      `;
      sec.appendChild(q5);
    }
    quizArea.appendChild(sec);
    bindQuestionEvents();
  }

  // ç¶å®šé¡Œç›®äº‹ä»¶
  function bindQuestionEvents(){
    quizArea.querySelectorAll('.check-btn').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const q = btn.closest('.question');
        const ans = q.dataset.answer;
        const fb = q.querySelector('.feedback');
        let ok=false;
        if(q.classList.contains('fill-in')){
          const v = normalize(q.querySelector('.fill-in-answer').value);
          if(!v){ fb.textContent='è«‹å¡«å…¥ç­”æ¡ˆ'; fb.className='feedback incorrect'; return; }
          ok = (v===ans);
        }else{
          const s=q.querySelector('input[type="radio"]:checked');
          if(!s){ fb.textContent='è«‹é¸æ“‡ç­”æ¡ˆ'; fb.className='feedback incorrect'; return; }
          ok = (s.value===ans);
        }
        fb.textContent = ok ? 'ç­”å°äº†ï¼ğŸ‰' : 'å†è©¦ä¸€æ¬¡ï¼ğŸ’ª';
        fb.className = 'feedback '+(ok?'correct':'incorrect');
        saveProgress(currentBase);
      });
    });
    quizArea.querySelectorAll('input[type="radio"],input[type="text"]').forEach(el=>{
      el.addEventListener('input', ()=>saveProgress(currentBase));
      el.addEventListener('change', ()=>saveProgress(currentBase));
    });
  }

  // é€²åº¦å„²å­˜ / è¼‰å…¥ï¼ˆæ¯ä¸»é¡Œç¨ç«‹ï¼‰
  function saveProgress(base){
    if(!base) return;
    const key = STORAGE_PREFIX+base;
    const data = {};
    quizArea.querySelectorAll('.question').forEach(q=>{
      const id=q.dataset.id; if(!id) return;
      if(q.classList.contains('fill-in')){
        data[id]={type:'text', value:q.querySelector('.fill-in-answer')?.value||""};
      }else{
        const s=q.querySelector('input[type="radio"]:checked');
        data[id]={type:'radio', value: s? s.value : ""};
      }
    });
    localStorage.setItem(key, JSON.stringify(data));
  }
  function loadProgress(base){
    if(!base) return;
    const key = STORAGE_PREFIX+base;
    const data = JSON.parse(localStorage.getItem(key)||"{}");
    Object.entries(data).forEach(([id,item])=>{
      const q = quizArea.querySelector(`[data-id="${id}"]`);
      if(!q) return;
      if(item.type==='text'){
        const inp=q.querySelector('.fill-in-answer');
        if(inp) inp.value=item.value||"";
      }else if(item.type==='radio' && item.value){
        const r=q.querySelector(`input[type="radio"][value="${item.value}"]`);
        if(r) r.checked=true;
      }
    });
  }
});
</script>
</body>
</html>
